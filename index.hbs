{{!< default}}

<html>

  <head>
    {{> "global-head"}}
    <title>421 | Tecnomagia para la vida real</title>
    <link href="{{asset "css/index.css"}}" rel="stylesheet" type="text/css">
    <link href="{{asset "css/file-browser.css"}}" rel="stylesheet" type="text/css">
  </head>
  <body>
    <div class="page-wrapper">
      {{> "general-styling"}} <!-- TODO: Revisar -->
      {{> "site-nav-es"}}
      <main>
        <!-- FEATURED POST -->
        {{> "index-featured-post" languageFilter="-'hash-en'"}}

        <!-- POPULAR POSTS -->
        {{> "index-highlighted-posts-es"}}

        <!-- LAST POSTS -->
        {{> "last-posts-es"}}

        <!-- WIKI -->
        {{!-- {{> "wiki-section-es"}} --}}

        <!-- Suscribite button mobile  -->
        <a href="/suscribite" style="color: white; text-decoration: none;">
          <button class="button sub-mobile-button" style="transition: transform 0.3s ease-in-out;">
            Suscribite
          </button>
        </a>
        <!-- FILE BROWSER (floating window system) -->
        {{> "file-browser"}}
      </main>

      {{> "site-footer"}}

    </div>
    <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6669c61faddc5cdc1cf55c96" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="{{asset "js/audio-effect.js"}}"></script>
    <script src="{{asset "js/hide-show-nav.js"}}"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        const readDiv = document.getElementById("read-div");
        const urlPathname = window.location.pathname;

        if (urlPathname.includes("en")) {
          readDiv.textContent = "Read";
        } else {
          readDiv.textContent = "Leer";
        }
      })
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        const modeSwitchButton = document.getElementById("mode-switch");
        const bodyElement = document.querySelector("body");
        const sunIcon = modeSwitchButton.querySelector('.is-sun');
        const moonIcon = modeSwitchButton.querySelector('.is-moon');

        // Check and apply the user's preference from localStorage
        if (localStorage.getItem("lightMode") === "enabled") {
          bodyElement.classList.add("light-mode");
          moonIcon.style.display = 'none';
          sunIcon.style.display = 'block';
          updateDivBorders("#121212");
        } else {
          bodyElement.classList.remove("light-mode");
          moonIcon.style.display = 'block';
          sunIcon.style.display = 'none';
          updateDivBorders("");
        }

        modeSwitchButton.addEventListener("click", function(e) {
          e.preventDefault();

          bodyElement.classList.toggle("light-mode");
          if (bodyElement.classList.contains("light-mode")) {
              sunIcon.style.display = 'block';
              moonIcon.style.display = 'none';
              localStorage.setItem("lightMode", "enabled");
              updateDivBorders("#121212");
          } else {
              sunIcon.style.display = 'none';
              moonIcon.style.display = 'block';
              localStorage.setItem("lightMode", "disabled");
              updateDivBorders("");
          }
        });

        function updateDivBorders(color) {
          document.querySelectorAll("div").forEach(function(div) {
            div.style.borderColor = color;
          });
        }
      });
    </script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const dropdownContainer = document.querySelector('.dropdown-container');
        const dropdownToggle = document.querySelector('.dropdown-toggle');
        const dropdownMenu = document.querySelector('.dropdown-menu');
        let isOpen = false;
        let hoverTimeout;

        dropdownToggle.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();

          if (isOpen) {
            closeDropdown();
          } else {
            openDropdown();
          }
        });

        dropdownContainer.addEventListener('mouseenter', function() {
          clearTimeout(hoverTimeout);
          openDropdown();
        });

        dropdownContainer.addEventListener('mouseleave', function() {
          hoverTimeout = setTimeout(() => {
            closeDropdown();
          }, 200);
        });

        document.addEventListener('click', function(e) {
          if (!dropdownContainer.contains(e.target)) {
            closeDropdown();
          }
        });

        document.addEventListener('keydown', function(e) {
          if (e.key === "Escape" && isOpen) {
            closeDropdown();
          }
        });

        function openDropdown() {
          isOpen = true;
          dropdownContainer.classList.add('active');

          const firstItem = dropdownMenu.querySelector('.dropdown-item');
          if (firstItem) {
            firstItem.focus();
          }
        }

        function closeDropdown() {
          isOpen = false;
          dropdownContainer.classList.remove('active')
        }

        // Smooth scroll effect for dropdown items
        const dropdownItems = document.querySelectorAll('.dropdown-item');
        dropdownItems.forEach(item => {
          item.addEventListener('click', function(e) {
            // Add a nice click effect
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
              this.style.transform = "";
            }, 150);
          });
        });
      })
    </script>
  </body>
</html>